import core

-- Linux is 'libc.so.6' and 'libm.so.6' for C standard library and math library
-- Windows would be 'msvcrt.dll' for C standard library functions
cpath = "msvcrt.dll"

-- Binding some functions from the C standard library and math library
-- For testing (Linux systems with glibc)
foreign strlen(cpath, "string") -> "int"
foreign abs(cpath, "int") -> "int"
foreign sqrt(cpath, "double") -> "double"
foreign pow(cpath, "double", "double") -> "double"
foreign ceil(cpath, "double") -> "double"
foreign floor(cpath, "double") -> "double"


def test_strings() do    
    texto1 = "Ol√°, Mundo!"
    "Text: " + texto1
    "Length: " + strlen(texto1)
    
    texto2 = "Hello, World!"
    "Text: " + texto2
    "Length: " + strlen(texto2)

    empty = ""
    "Empty string length: " + strlen(empty)
end

def test_integers() do
    print("=== Integer Tests ===\n")
    
    "abs(-42) = " + abs(-42)    
    "abs(42) = " + abs(42)    
    "abs(0) = " + abs(0)    
    "abs(-999) = " + abs(-999)
end

def test_doubles() do
    "sqrt(16.0) = " + sqrt(16.0)
    "sqrt(2.0) = " + sqrt(2.0)
    "sqrt(100.0) = " + sqrt(100.0)
    "pow(2.0, 8.0) = " + pow(2.0, 8.0)
    "pow(3.0, 3.0) = " + pow(3.0, 3.0)
    "pow(10.0, 2.0) = " + pow(10.0, 2.0)
    "ceil(3.14) = " + ceil(3.14)
    "floor(3.14) = " + floor(3.14)
end

def test_mixed() do    
    text = "Programming"
    len = strlen(text)

    "The word '" + text + "' has " + len + " characters"

    sqrt_len = sqrt(int_to_double(len))
    "Square root of length: " + sqrt_len + "\n"

    abs_result = abs(-10)
    "abs(-10) = " + abs_result + "\n"

    power = pow(int_to_double(abs_result), int_to_double(2))
    "That number squared: " + power + "\n\n"
end

def main() do
    test_strings()
    test_integers()
    test_doubles()
    test_mixed()
    
    "=== All Tests Complete ===\n"
end

main()